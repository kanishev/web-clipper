!function(){var e="",t={id:"Weje",title:"Weje Clipper",contexts:["image","selection"]};chrome.storage.local.get().then((function(n){n.token&&(e=n.token,chrome.contextMenus.create(t))})),chrome.contextMenus.onClicked.addListener((function(t){chrome.tabs.query({active:!0,currentWindow:!0},(function(n){chrome.tabs.sendMessage(n[0].id,{target:t,token:e})}))})),chrome.runtime.onMessage.addListener((function(t,n,r){"getCurrentUrl"==t&&chrome.tabs.query({active:!0,currentWindow:!0},(function(e){chrome.tabs.sendMessage(e[0].id,"getCurrentUrl")})),"getPinnerStatus"==t&&chrome.storage.local.get().then((function(e){var t=e.pinnerStatus;chrome.tabs.query({active:!0,currentWindow:!0},(function(e){chrome.tabs.sendMessage(e[0].id,{pinnerStatus:t})}))})),t.pinnerStatus&&chrome.tabs.query({active:!0,currentWindow:!0},(function(e){chrome.tabs.sendMessage(e[0].id,{pinnerStatus:t.pinnerStatus})})),"getToken"==t&&r(e)})),chrome.runtime.onMessageExternal.addListener((function(n,r,o){return n&&(n.message?"version"==n.message&&o({version:chrome.runtime.getManifest().version}):n.token&&(chrome.action.enable(),chrome.contextMenus.create(t),e=n.token,chrome.storage.local.set({token:e}))),!0}))}();