!function(){var e={uid:null,apiKey:null},t={id:"Weje",title:"Weje Clipper",contexts:["image","selection"]};chrome.storage.local.get().then((function(n){n.clientData&&(e=n.clientData,chrome.contextMenus.create(t))})),chrome.contextMenus.onClicked.addListener((function(t){chrome.tabs.query({active:!0,currentWindow:!0},(function(n){chrome.tabs.sendMessage(n[0].id,{target:t,clientData:e})}))})),chrome.runtime.onMessage.addListener((function(t,n,r){"getCurrentUrl"==t&&chrome.tabs.query({active:!0,currentWindow:!0},(function(e){chrome.tabs.sendMessage(e[0].id,"getCurrentUrl")})),"getPinnerStatus"==t&&chrome.storage.local.get().then((function(e){var t=e.pinnerStatus;chrome.tabs.query({active:!0,currentWindow:!0},(function(e){chrome.tabs.sendMessage(e[0].id,{pinnerStatus:t})}))})),t.pinnerStatus?chrome.tabs.query({active:!0,currentWindow:!0},(function(e){chrome.tabs.sendMessage(e[0].id,{pinnerStatus:t.pinnerStatus})})):"getToken"==t&&r(e)})),chrome.runtime.onMessageExternal.addListener((function(n,r,a){return n&&(n.message?"version"==n.message&&a({version:chrome.runtime.getManifest().version}):n.apiKey&&n.uid&&(chrome.action.enable(),chrome.contextMenus.create(t),e.apiKey=n.apiKey,e.uid=n.uid,chrome.storage.local.set({clientData:e}))),!0}))}();