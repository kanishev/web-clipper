let token="",contextMenu={id:"Weje",title:"Weje Clipper",contexts:["image","selection"]};chrome.contextMenus.onClicked.addListener((function(e){chrome.tabs.query({active:!0,currentWindow:!0},(function(n){chrome.tabs.sendMessage(n[0].id,{target:e,token:token},(function(){console.log("sent target")}))}))})),chrome.runtime.onMessage.addListener((function(e,n,t){e.pinnerStatus&&(console.log(e.pinnerStatus),t({farewell:"goodbye"}))})),chrome.runtime.onMessageExternal.addListener((function(e,n,t){return e&&(e.message?"version"==e.message&&t({version:chrome.runtime.getManifest().version}):e.token&&(chrome.action.enable(),chrome.contextMenus.create(contextMenu),token=e.token,chrome.storage.local.set({token:token},(function(){console.log("Value is set to "+token)})),t({message:"Token has been recievedd"}))),!0}));