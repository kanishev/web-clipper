{"version":3,"file":"background.js","mappings":";;;;;AAAA;AAEA;AACA;AACA;AAFA;AAKA;AACA;AACA;AACA;AAHA;AAMA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAFA;AAKA;AACA;AACA;AAFA;AAIA;AAEA;AAEA;AACA;;AAIA;AACA;AACA;AACA;AACA;AADA;AAGA;AALA;AAOA;AACA;AACA;;AACA;AACA;AAEA;AACA;AAFA;AAKA;AACA;AACA;AADA;AAGA;AAJA;AAMA;AAEA;;AACA;AACA;AACA;AAEA;AACA;AAFA;AAKA;AACA;AACA;AAGA;AACA;AAFA;AAJA;AASA;AAEA;AACA;;AACA;AACA;AAEA;AACA;AAFA;AAKA;AACA;AADA;AAGA;AAEA;AACA;AAEA;AAKA;;AACA;AACA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AAGA;AACA;;AACA;AACA;AAGA","sources":["webpack:///./background.js"],"sourcesContent":["var clientData, contextMenu;\r\n\r\nclientData = {\r\n  uid: null,\r\n  apiKey: null,\r\n};\r\n\r\ncontextMenu = {\r\n  id: \"Weje\",\r\n  title: \"Weje web clipper\",\r\n  contexts: [\"all\"],\r\n};\r\n\r\nchrome.storage.local.get().then(function (storage) {\r\n  if (storage.clientData) {\r\n    clientData = storage.clientData;\r\n    chrome.contextMenus.create(contextMenu);\r\n  }\r\n});\r\n\r\nchrome.contextMenus.onClicked.addListener(function (target) {\r\n  chrome.tabs.query(\r\n    {\r\n      active: true,\r\n      currentWindow: true,\r\n    },\r\n    function (tabs) {\r\n      chrome.tabs.sendMessage(tabs[0].id, {\r\n        target: target,\r\n        clientData: clientData,\r\n      });\r\n    }\r\n  );\r\n});\r\n\r\nchrome.runtime.onMessage.addListener(function (request, sender, sendResponse) {\r\n  let url =\r\n    MODE == \"development\"\r\n      ? \"http://clipper.stage.weje.io/push\"\r\n      : \"http://clipper.app.weje.io/push\";\r\n  if (request.content) {\r\n    fetch(url, {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify(request.content),\r\n    })[\"catch\"](function (error) {\r\n      console.error(\"Error:\", error);\r\n    });\r\n  }\r\n  if (request === \"getCurrentUrl\") {\r\n    chrome.tabs.query(\r\n      {\r\n        active: true,\r\n        currentWindow: true,\r\n      },\r\n      function (tabs) {\r\n        chrome.tabs.sendMessage(tabs[0].id, {\r\n          target: {\r\n            linkUrl: \"current\",\r\n          },\r\n          clientData: clientData,\r\n        });\r\n      }\r\n    );\r\n  }\r\n  if (request === \"getPinnerStatus\") {\r\n    chrome.storage.local.get().then(function (store) {\r\n      chrome.tabs.query(\r\n        {\r\n          active: true,\r\n          currentWindow: true,\r\n        },\r\n        function (tabs) {\r\n          chrome.tabs.sendMessage(tabs[0].id, {\r\n            clientData: clientData,\r\n            pinnerStatus: store.clientData\r\n              ? store.pinnerStatus\r\n              : {\r\n                  text: false,\r\n                  image: false,\r\n                },\r\n          });\r\n        }\r\n      );\r\n    });\r\n  }\r\n  if (request.pinnerStatus) {\r\n    chrome.tabs.query(\r\n      {\r\n        active: true,\r\n        currentWindow: true,\r\n      },\r\n      function (tabs) {\r\n        chrome.tabs.sendMessage(tabs[0].id, {\r\n          pinnerStatus: request.pinnerStatus,\r\n        });\r\n      }\r\n    );\r\n  }\r\n});\r\n\r\nchrome.runtime.onMessageExternal.addListener(function (\r\n  request,\r\n  sender,\r\n  sendResponse\r\n) {\r\n  var version;\r\n  if (request) {\r\n    if (request.message && request.message === \"version\") {\r\n      version = chrome.runtime.getManifest().version;\r\n      sendResponse({\r\n        version: version,\r\n      });\r\n    } else if (request.apiKey && request.uid) {\r\n      chrome.action.enable();\r\n      chrome.contextMenus.create(contextMenu);\r\n      clientData.apiKey = request.apiKey;\r\n      clientData.uid = request.uid;\r\n      chrome.storage.local.set({\r\n        clientData: clientData,\r\n      });\r\n    }\r\n  }\r\n  return true;\r\n});\r\n\r\n// ---\r\n// generated by coffee-script 1.9.2\r\n"],"names":[],"sourceRoot":""}